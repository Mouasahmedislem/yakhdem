<% grouped[from].messages.forEach(msg => { %>
  <div class="msg">
    <span class="meta">[<%= new Date(msg.createdAt).toLocaleString() %>]</span>
    <strong><%= msg.type %>:</strong>
    <div>
      <% if (msg.type === 'image') { %>
        <img src="<%= msg.media %>" 
             onerror="this.src='/images/placeholder.jpg';"
             alt="Image" style="max-width:200px;border-radius:6px;" />
      <% } else if (msg.type === 'audio') { %>
        <audio controls>
          <source src="<%= msg.media %>" type="audio/ogg">
          Votre navigateur ne supporte pas l'audio.
        </audio>
      <% } else if (msg.type === 'document' || msg.type === 'video') { %>
        <a href="<%= msg.media %>" target="_blank">ðŸ“Ž Voir le fichier</a>
      <% } else { %>
        <%= msg.text || msg.payload || "..." %>
      <% } %>
    </div>
  </div>
<% }) %>
