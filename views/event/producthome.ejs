 
<!DOCTYPE html>
<html lang="en">
<head>

<!-- Add Three.js and STL loader libraries -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/STLLoader.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="referrer" content="strict-origin-when-cross-origin">
<!-- Meta Pixel Code -->
<% if (process.env.FB_PIXEL_ID) { %>
<!-- Facebook Pixel Code -->


<script>
!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');

// Create config object dynamically
var pixelConfig = {};

// Only add parameters that have values
<% if (user && user.email) { %> pixelConfig.em = '<%= user.email %>'; <% } %>
<% if (user && user.firstName) { %> pixelConfig.fn = '<%= user.firstName %>'; <% } %>
<% if (user && user.lastName) { %> pixelConfig.ln = '<%= user.lastName %>'; <% } %>
<% if (user && user.numero) { %> pixelConfig.ph = '<%= user.numero %>'; <% } %>
<% if (user && user._id) { %> pixelConfig.external_id = '<%= user._id %>'; <% } %>

// Initialize with dynamic config
fbq('init', '<%= process.env.FB_PIXEL_ID %>', pixelConfig);
fbq('track', 'PageView');

// Delay ViewContent to ensure pixel is loaded
setTimeout(function() {
  fbq('track', 'ViewContent', {
    content_name: '<%= producthome.title %>',
    content_ids: ['<%= producthome._id %>'],
    content_type: 'product',
    value: <%= producthome.price %>,
    currency: 'DZD',
    contents: [{
      id: '<%= producthome._id %>',
      quantity: 1,
      item_price: <%= producthome.price %>
    }]
  }, {
    eventID: '<%= metaEventIdView %>'
  });
}, 2000);
</script>
<noscript>
  <img height="1" width="1" style="display:none" 
       src="https://www.facebook.com/tr?id=<%= process.env.FB_PIXEL_ID %>&ev=PageView&noscript=1"/>
</noscript>
<!-- End Facebook Pixel Code -->
<% } %>
<script type="text/javascript">
    (function(c,l,a,r,i,t,y){
        c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
        t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
        y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
    })(window, document, "clarity", "script", "t8r0mi7k1l");
</script>
<!-- Open Graph Meta Tags -->
<meta property="og:type" content="product" />
<meta property="og:title" content="<%= producthome.title %>" />
<meta property="og:description" content="<%= producthome.description %>" />
<meta property="og:image" content="<%= producthome.image %>" />
<meta property="og:url" content="https://<%= req.get('host') + req.originalUrl %>" />
<meta property="og:site_name" content="Paintello" />
<meta property="product:price:amount" content="<%= producthome.price %>" />
<meta property="product:price:currency" content="DZD" />

  <title>Paintello Home</title>
  <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
<link rel="manifest" href="/favicon/site.webmanifest">  
  <meta name="theme-color" content="#ffffff">  <link href='https://cdn.jsdelivr.net/npm/boxicons@2.0.5/css/boxicons.min.css' rel='stylesheet'>
  <link rel="stylesheet" href="/assets/vendor/font-awesome/css/fontawesome-all.min.css">
  <link rel="stylesheet" href="/assets/vendor/animate.css/animate.min.css">
  <link rel="stylesheet" href="/assets/vendor/hs-megamenu/src/hs.megamenu.css">
<!-- Bootstrap 4 CSS -->
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
<!-- Font Awesome (optional for icons) -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.11.2/css/all.css">
  <!-- Bootstrap core CSS -->
   <!-- Bootstrap core CSS -->
  <link href="../../css/bootstrap.min.css" rel="stylesheet">
  <!-- Material Design Bootstrap -->
  <link href="../../css/mdb.min.css" rel="stylesheet">
<!-- Add the slick-theme.css if you want default styling -->
<link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.css"/>
<!-- Add the slick-theme.css if you want default styling -->
<link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick-theme.css"/>
  <!-- Material Design Bootstrap -->
  <link href="/css/mdb.min.css" rel="stylesheet">
  <link href="/css/magiczoomplus.css" rel="stylesheet">
  <link href="/css/zoomm.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>

  <style>
  
 /* public/css/home.css */
body {
  font-family: 'Helvetica Neue', sans-serif;
  margin: 0;
  padding: 0;
  background-color: #fdfdfd;
  color: #333;
}

header, footer {
  background: white;
  padding: 20px 40px;
  text-align: center;
  border-bottom: 1px solid #ddd;
}

.logo {
  font-size: 2.5rem;
  font-weight: bold;
  letter-spacing: 2px;
}

.banner {
  width: 100%;
  height: 80vh;
  background-size: cover;
  background-position: center;
  display: flex;
  justify-content: center;
  align-items: center;
}

.banner-text {
  background: rgba(255, 255, 255, 0.85);
  padding: 40px;
  font-size: 2rem;
  text-transform: uppercase;
}

.section {
  padding: 60px 20px;
  max-width: 1200px;
  margin: auto;
}


.section-title {
  font-size: 2rem;
  margin-bottom: 40px;
  text-align: center;
}

.products {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 30px;
}

.product {
  text-align: center;
}

.product img {
  width: 100%;
  border: 1px solid #eee;
  transition: transform 0.3s ease;
}

.product img:hover {
  transform: scale(1.05);
}

footer {
  margin-top: 60px;
  font-size: 0.9rem;
}

.logo-img {
  height: 60px;

}



.badge-danger {
  position: absolute;
  top: -5px;
  right: -10px;
  font-size: 0.75rem;
}
.logo {
  font-size: 1.6rem;
  font-weight: 600;
  color: #222;
}





.cart-btn {
  padding: 8px 16px;
  background-color: #f0f0f0;
  border-radius: 20px;
  color: #222;
  font-weight: 500;
  transition: background-color 0.3s;
}

.cart-btn:hover {
  background-color: #ddd;
}
.add-to-cart-button {
  display: inline-block;
  background-color: #f8f8f8;
  color: #222;
  padding: 8px 16px;
  border: 1px solid #ccc;
  border-radius: 25px;
  text-decoration: none;
  font-size: 0.9rem;
  transition: background-color 0.3s;
}

.add-to-cart-button:hover {
  background-color: #e0e0e0;
}





.product-title {
  font-size: 2rem;
  margin-bottom: .5rem;
}

.product-price {
  font-size: 1.5rem;
  color: #f4791f;
  margin-bottom: 1rem;
}

/* Zoom-on-hover for carousel images */

.zoomable:hover {
  transform: scale(1.1);
}

/* Tab styling override (optional) */
#infoTab .nav-link {
  color: #555;
}
#infoTab .nav-link.active {
  color: #f4791f;
  border-color: #f4791f #f4791f #fff;
}
.zoomable {
  transition: transform .2s ease;
  cursor: zoom-in;
}
.zoomable:hover {
  transform: scale(1.1);
}
.product-title { font-size: 2rem; margin-bottom: .5rem; }
.product-price { font-size: 1.5rem; color: #f4791f; }
.logo-img {
  height: 45px;
  width: auto;
}

.cart-badge {
  position: absolute;
  top: 0px;
  right: 0px;
  font-size: 0.7rem;
  padding: 2px 6px;
  border-radius: 50%;
}

.product-video-section {
  background: #fff;
  padding: 20px;
  border: 1px solid #eee;
  border-radius: 6px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.05);
}

.product-video-section h3 {
  font-size: 1.4rem;
  font-weight: 600;
  color: #333;
}

.video-thumbnail {
  position: relative;
  display: inline-block;
  cursor: pointer;
  background: #000;
}

.video-thumbnail img {
  max-width: 100%;
  border-radius: 8px;
  display: block;
}

.play-button {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 3rem;
  color: white;
  background: rgba(0, 0, 0, 0.6);
  border-radius: 50%;
  padding: 10px 20px;
  pointer-events: none;
}



</style>

</head>
<body>


  <header>
    <nav class="navbar navbar-expand-lg navbar-light bg-white fixed-top scrolling-navbar">
  <div class="container">

    <!-- LOGO -->
    <a class="logo" href="/">
      <img src="/img/logo.png" alt="Paintello Home Logo" style="max-height: 120px;">
    </a>

    

    <!-- Navbar links -->
  
      <ul class="navbar-nav nav-flex-icons ml-auto ">

        <!-- PROFILE -->
        <li class="nav-item dropdown">
        
             <a class="nav-link dropdown" id="menu1" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              <i class="fas fa-user"></i>
            </a>
          <div class="dropdown-menu dropdown-menu-right bootstrap-menu  white scrollbar-default" aria-labelledby="menu1">
                        <% if (login){ %>
                          <a class="dropdown-item" href="/user/profile">profile</a>
                           <a class="dropdown-item" href="/user/logout">Logout</a>
                           <% } else{ %>
                           <a class="dropdown-item" href="/user/signup">Register</a>
                           <a class="dropdown-item" href="/user/signin">Sing up</a>
                           <a class="dropdown-item" href="/track-login">Track Order</a>
                           
                           <% } %>
                 </div> 
           
          
        </li>

        <!-- CART -->
        <li class="nav-item mx-2 position-relative">
          <a class="nav-link" href="/shop" title="Cart">
            <i class="fas fa-shopping-cart"></i>
            <% if (session.cart && session.cart.totalQty > 0) { %>
              <span class="badge badge-danger cart-badge"><%= session.cart.totalQty %></span>
            <% } %>
          </a>
        </li>

      </ul>
    </div>
  
</nav>
  </header>

 <div class="banner" style="background-image: url('https://live.staticflickr.com/65535/54530748939_dda2a74c86.jpg');">
   <div class="banner-text">
                <h1 class="h1-responsive font-weight-bold mt-sm-5 mb-4 wow fadeInLeft" data-wow-delay="0.3s">Transform Your Home with Color & Comfort</h1>
                <hr class="hr-light wow fadeInLeft" data-wow-delay="0.3s">
 <a class="btn btn-white btn-rounded btn-lg orange-text font-weight-bold ml-lg-0 wow fadeInLeft" data-wow-delay="0.4s" href="/"><img src="/favicon/android-chrome-192x192.png" alt="Paintello Logo" style="max-height: 80px;"></a>
 <a class="btn btn-white btn-rounded btn-lg orange-text font-weight-bold ml-lg-0 wow fadeInLeft" data-wow-delay="0.4s" href="/paintello"><img src="/img/logo.png" alt="Paintello Logo" style="max-height: 80px;"></a>
              </div>
            </div>
  <div class="container my-5">
  <div class="row">
    <!-- IMAGE SLIDER -->
    <div class="col-md-6">
      <div id="productCarousel" class="carousel slide" data-ride="carousel">
        <ol class="carousel-indicators">
          <% producthome.image.forEach((img, i) => { %>
            <li data-target="#productCarousel" data-slide-to="<%= i %>" class="<%= i===0?'active':'' %>"></li>
          <% }) %>
        </ol>
        <div class="carousel-inner">
          <% producthome.image.forEach((img, i) => { %>
            <div class="carousel-item <%= i===0?'active':'' %>">
              <img src="<%= img %>" class="d-block w-100 zoomable" alt="Slide <%= i+1 %>">
            </div>
          <% }) %>
        </div>
        <a class="carousel-control-prev" href="#productCarousel" role="button" data-slide="prev">
          <span class="carousel-control-prev-icon"></span>
        </a>
        <a class="carousel-control-next" href="#productCarousel" role="button" data-slide="next">
          <span class="carousel-control-next-icon"></span>
        </a>
      </div>
    </div>

    <!-- DETAILS -->
    <div class="col-md-6">
      <h1 class="product-title"><%= producthome.title %></h1>
      <p class="product-price"><%= producthome.price.toFixed(2) %> DA</p>
<form action="/add-to-cart-producthome/<%= producthome._id %>" method="GET" 
      onsubmit="return handleAddToCart(event, '<%= producthome.title %>', <%= producthome.price %>, '<%= producthome._id %>')">
  <button type="submit" class="btn btn-primary btn-lg mb-4">
    <i class="fas fa-cart-plus mr-2"></i>Add to Cart
  </button>
</form>

 
      <ul class="nav nav-tabs" id="infoTab" role="tablist">
        <li class="nav-item">
          <a class="nav-link active" id="desc-tab" data-toggle="tab" href="#desc" role="tab">Description</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" id="info-tab" data-toggle="tab" href="#info" role="tab">Information</a>
        </li>
      </ul>
      <div class="tab-content p-3 border border-top-0" id="infoTabContent">
        <div class="tab-pane fade show active" id="desc" role="tabpanel">
          <p><%= producthome.description %></p>
        </div>
        <div class="tab-pane fade" id="info" role="tabpanel">
          <ul class="list-unstyled">
            <% for (let key in producthome.details) { %>
              <li><strong><%= key %>:</strong> <%= producthome.details[key] %></li>
            <% } %>
          </ul>
        </div>
      </div>
    </div>
  </div>


</div>
<% if (producthome.videoId) { %>
<div class="product-video-section mt-5 text-center" style="max-width: 400px; margin: auto;">
  <h3 class="mb-3">Product Video</h3>
  <iframe
    src="https://www.youtube.com/embed/<%= producthome.videoId %>?rel=0&autoplay=0&playsinline=1"
    width="100%"
    height="700"
    frameborder="0"
    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
    allowfullscreen
    style="border-radius: 8px;">
  </iframe>
</div>
<% } %>

<% if (has3DModel) { %>
<div class="product-3d-section mt-5">
  <div class="container">
    <h3 class="text-center mb-4">View This Vase in 3D</h3>
    <p class="text-center mb-4">Rotate, zoom, and explore this vase from all angles before purchasing</p>
    
    <div class="row">
      <div class="col-md-8 mx-auto">
        <!-- 3D Viewer Container -->
        <div id="modelViewer" class="model-viewer-container">
          <div class="model-loading text-center py-5">
            <div class="spinner-border text-primary" role="status">
              <span class="sr-only">Loading 3D Model...</span>
            </div>
            <p class="mt-3">Loading 3D Model...</p>
          </div>
        </div>
        
        <!-- Viewer Controls -->
        <div class="viewer-controls mt-3 text-center">
          <button id="resetView" class="btn btn-outline-primary btn-sm mr-2">
            <i class="fas fa-sync-alt"></i> Reset View
          </button>
          <button id="autoRotate" class="btn btn-outline-primary btn-sm mr-2">
            <i class="fas fa-redo"></i> Auto Rotate
          </button>
          <div class="btn-group mr-2" role="group">
            <button id="viewTop" class="btn btn-outline-secondary btn-sm" title="Top View">
              <i class="fas fa-arrow-up"></i>
            </button>
            <button id="viewFront" class="btn btn-outline-secondary btn-sm" title="Front View">
              <i class="fas fa-arrow-down"></i>
            </button>
            <button id="viewSide" class="btn btn-outline-secondary btn-sm" title="Side View">
              <i class="fas fa-arrow-right"></i>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    init3DViewer(
      '<%= model3DSettings.stlFile %>',
      '<%= model3DSettings.defaultColor %>',
      <%= model3DSettings.autoRotate %>
    );
  });
</script>
<% } %>
<script>
function init3DViewer(stlFilePath, defaultColor, autoRotateEnabled) {
  // Variables
  let scene, camera, renderer, controls, model;
  let container = document.getElementById('modelViewer');
  let autoRotate = autoRotateEnabled;
  let defaultColorHex = defaultColor;
  
  // Initialize Three.js scene
  function init() {
    // Scene setup
    scene = new THREE.Scene();
    scene.background = new THREE.Color(0xf8f9fa);
    
    // Camera setup
    camera = new THREE.PerspectiveCamera(45, container.clientWidth / container.clientHeight, 0.1, 1000);
    camera.position.z = 5;
    
    // Renderer setup
    renderer = new THREE.WebGLRenderer({ antialias: true });
    renderer.setSize(container.clientWidth, container.clientHeight);
    renderer.setPixelRatio(window.devicePixelRatio);
    container.innerHTML = '';
    container.appendChild(renderer.domElement);
    
    // Lighting
    const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
    scene.add(ambientLight);
    
    const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
    directionalLight.position.set(10, 10, 5);
    scene.add(directionalLight);
    
    // Controls
    controls = new THREE.OrbitControls(camera, renderer.domElement);
    controls.enableDamping = true;
    controls.dampingFactor = 0.05;
    
    // Load STL model
    const loader = new THREE.STLLoader();
    loader.load(stlFilePath, function(geometry) {
      const material = new THREE.MeshPhongMaterial({ 
        color: defaultColorHex,
        specular: 0x111111,
        shininess: 200
      });
      
      model = new THREE.Mesh(geometry, material);
      
      // Center the model
      geometry.computeBoundingBox();
      const center = geometry.boundingBox.getCenter(new THREE.Vector3());
      model.position.x = -center.x;
      model.position.y = -center.y;
      model.position.z = -center.z;
      
      // Scale if needed
      const size = geometry.boundingBox.getSize(new THREE.Vector3());
      const maxDim = Math.max(size.x, size.y, size.z);
      const scale = 2 / maxDim;
      model.scale.set(scale, scale, scale);
      
      scene.add(model);
      
      // Adjust camera to fit model
      const box = new THREE.Box3().setFromObject(model);
      const boxSize = box.getSize(new THREE.Vector3()).length();
      const boxCenter = box.getCenter(new THREE.Vector3());
      
      controls.reset();
      camera.near = boxSize / 100;
      camera.far = boxSize * 100;
      camera.updateProjectionMatrix();
      
      camera.position.copy(boxCenter);
      camera.position.x += boxSize * 0.8;
      camera.position.y += boxSize * 0.5;
      camera.position.z += boxSize * 0.8;
      controls.update();
      
    }, undefined, function(error) {
      console.error('Error loading STL file:', error);
      container.innerHTML = `
        <div class="alert alert-danger text-center">
          <i class="fas fa-exclamation-triangle"></i>
          Failed to load 3D model. Please try again later.
        </div>
      `;
    });
    
    // Handle window resize
    window.addEventListener('resize', onWindowResize);
    
    // Animation loop
    animate();
  }
  
  // ... rest of the 3D viewer functions remain the same
  function onWindowResize() {
    camera.aspect = container.clientWidth / container.clientHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(container.clientWidth, container.clientHeight);
  }
  
  function animate() {
    requestAnimationFrame(animate);
    
    if (autoRotate && model) {
      model.rotation.y += 0.005;
    }
    
    controls.update();
    renderer.render(scene, camera);
  }
  
  // Initialize the viewer
  init();
  
  // Set up control buttons
  document.getElementById('resetView').addEventListener('click', function() {
    controls.reset();
  });
  
  document.getElementById('autoRotate').addEventListener('click', function() {
    autoRotate = !autoRotate;
    this.classList.toggle('active', autoRotate);
  });
  
  // ... other control button event listeners
}

</script>

<div itemscope itemtype="https://schema.org/Product">
  <meta itemprop="productID" content="<%= producthome._id %>" />
  <meta itemprop="name" content="<%= producthome.title %>" />
  <meta itemprop="description" content="<%= producthome.description %>" />
  <meta itemprop="image" content="<%= producthome.image %>" />

  <div itemprop="offers" itemscope itemtype="https://schema.org/Offer">
    <meta itemprop="priceCurrency" content="DZD" />
    <meta itemprop="price" content="<%= producthome.price %>" />
    <meta itemprop="availability" content="https://schema.org/InStock" />
    <meta itemprop="url" content="https://<%= req.get('host') + req.originalUrl %>" />
  </div>
</div>

<script type="application/ld+json">
{
  "@context": "https://schema.org/",
  "@type": "Product",
  "name": "<%= producthome.title %>",
  "image": "<%= producthome.image %>",
  "description": "<%= producthome.description %>",
  "sku": "<%= producthome._id %>",
  "offers": {
    "@type": "Offer",
    "url": "https://<%= req.get('host') + req.originalUrl %>",
    "priceCurrency": "DZD",
    "price": "<%= producthome.price %>",
    "availability": "https://schema.org/InStock"
  }
}
</script>



 <script>
    function toggleAccordion() {
      document.getElementById("accordionContent").classList.toggle("open");
    }
  </script>



<script>
  function handleAddToCart(event, title, price, id) {
    // Fire AddToCart event
    fbq('track', 'AddToCart', {
      content_name: title,
      content_ids: [id],
      content_type: 'product',
      value: price,
      currency: 'DZD',
      contents: [
        {
          id: id,
          quantity: 1,
          item_price: price
        }
      ]
    }, {
      eventID: '<%= metaEventIdCart %>'
    });

    return true; // let the form submit continue
  }
</script>


<script>
  document.addEventListener("DOMContentLoaded", function() {
    document.querySelectorAll(".video-thumbnail").forEach(function(thumbnail) {
      thumbnail.addEventListener("click", function() {
        let videoId = this.getAttribute("data-video-id");

        // Replace thumbnail with the working iframe
        this.innerHTML = `
          <div class="embed-responsive embed-responsive-16by9">
            <iframe 
              src="https://www.youtube.com/embed/${videoId}?autoplay=1&rel=0&playsinline=1"
              frameborder="0"
              allow="autoplay; encrypted-media; gyroscope; picture-in-picture"
              allowfullscreen
              style="width:100%; height:100%;">
            </iframe>
          </div>
        `;
      });
    });
  });
</script>





<%- include ("../partials/footer") %>.
